{% extends 'base.html' %}

{% block title %}–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ - –ù–æ–≤–æ—Å—Ç–Ω–æ–π –ø–æ—Ä—Ç–∞–ª{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <h1>üìã –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å—Ç–∞—Ç–µ–π</h1>
            <p class="lead">
                –ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –≤–∞—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                –æ –Ω–æ–≤—ã—Ö —Å—Ç–∞—Ç—å—è—Ö –Ω–∞ –≤–∞—à—É —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é –ø–æ—á—Ç—É
            </p>

            {% if not user.is_authenticated %}
            <div class="alert alert-info">
                <strong>‚ÑπÔ∏è</strong>
                <a href="{% url 'account_login' %}" class="alert-link">–í–æ–π–¥–∏—Ç–µ</a>
                –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            </div>
            {% endif %}
        </div>
    </div>

    <div class="row mt-4">
        {% for category in categories %}
        <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100">
                <div class="card-body">
                    <h5 class="card-title">üè∑Ô∏è {{ category.name }}</h5>
                    <p class="card-text">
                        <small class="text-muted">
                            üìä –°—Ç–∞—Ç–µ–π: {{ category.post_set.count }}<br>
                            üë• –ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: {{ category.subscribers.count }}
                        </small>
                    </p>

                    {% if user.is_authenticated %}
                        {% if category.id in user_subscriptions %}
                            <div class="alert alert-success py-2">
                                <small>‚úÖ –í—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é</small>
                            </div>
                            <a href="{% url 'unsubscribe_category' category.id %}"
                               class="btn btn-outline-danger btn-sm">
                                üîï –û—Ç–ø–∏—Å–∞—Ç—å—Å—è
                            </a>
                        {% else %}
                            <a href="{% url 'subscribe_category' category.id %}"
                               class="btn btn-primary btn-sm">
                                üîî –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è
                            </a>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="alert alert-warning">
                üì≠ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω—ã. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –¥–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}